(function(e,t,i){"use strict";if(typeof module!=="undefined"&&module.exports){module.exports=i(t,e)}else if(typeof define==="function"&&define.amd){define("factory",function(){return i(t,e)})}else{e[t]=i(t,e)}})(window,"detectZoom",function(){var e=function(){return window.devicePixelRatio||1};var t=function(){return{zoom:1,devicePxPerCssPx:1}};var i=function(){var t=Math.round(screen.deviceXDPI/screen.logicalXDPI*100)/100;return{zoom:t,devicePxPerCssPx:t*e()}};var r=function(){var t=Math.round(document.documentElement.offsetHeight/window.innerHeight*100)/100;return{zoom:t,devicePxPerCssPx:t*e()}};var n=function(){var t=Math.abs(window.orientation)==90?screen.height:screen.width;var i=t/window.innerWidth;return{zoom:i,devicePxPerCssPx:i*e()}};var a=function(){var t=function(e){return e.replace(/;/g," !important;")};var i=document.createElement("div");i.innerHTML="1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>0";i.setAttribute("style",t("font: 100px/1em sans-serif; -webkit-text-size-adjust: none; text-size-adjust: none; height: auto; width: 1em; padding: 0; overflow: visible;"));var r=document.createElement("div");r.setAttribute("style",t("width:0; height:0; overflow:hidden; visibility:hidden; position: absolute;"));r.appendChild(i);document.body.appendChild(r);var n=1e3/i.clientHeight;n=Math.round(n*100)/100;document.body.removeChild(r);return{zoom:n,devicePxPerCssPx:n*e()}};var o=function(){var e=u("min--moz-device-pixel-ratio","",0,10,20,1e-4);e=Math.round(e*100)/100;return{zoom:e,devicePxPerCssPx:e}};var s=function(){return{zoom:o().zoom,devicePxPerCssPx:e()}};var c=function(){var t=window.top.outerWidth/window.top.innerWidth;t=Math.round(t*100)/100;return{zoom:t,devicePxPerCssPx:t*e()}};var u=function(e,t,i,r,n,a){var o;var s,c,u;if(window.matchMedia){o=window.matchMedia}else{s=document.getElementsByTagName("head")[0];c=document.createElement("style");s.appendChild(c);u=document.createElement("div");u.className="mediaQueryBinarySearch";u.style.display="none";document.body.appendChild(u);o=function(e){c.sheet.insertRule("@media "+e+"{.mediaQueryBinarySearch "+"{text-decoration: underline} }",0);var t=getComputedStyle(u,null).textDecoration=="underline";c.sheet.deleteRule(0);return{matches:t}}}var l=d(i,r,n);if(u){s.removeChild(c);document.body.removeChild(u)}return l;function d(i,r,n){var s=(i+r)/2;if(n<=0||r-i<a){return s}var c="("+e+":"+s+t+")";if(o(c).matches){return d(s,r,n-1)}else{return d(i,s,n-1)}}};var l=function(){var e=t;if(!isNaN(screen.logicalXDPI)&&!isNaN(screen.systemXDPI)){e=i}else if(window.navigator.msMaxTouchPoints){e=r}else if("orientation"in window&&typeof document.body.style.webkitMarquee==="string"){e=n}else if(typeof document.body.style.webkitMarquee==="string"){e=a}else if(navigator.userAgent.indexOf("Opera")>=0){e=c}else if(window.devicePixelRatio){e=s}else if(o().zoom>.001){e=o}return e}();return{zoom:function(){return l().zoom},device:function(){return l().devicePxPerCssPx}}});var wpcom_img_zoomer={zoomed:false,timer:null,interval:1e3,imgNeedsSizeAtts:function(e){if(e.getAttribute("width")!==null||e.getAttribute("height")!==null)return false;if(e.width<e.naturalWidth||e.height<e.naturalHeight)return false;return true},updateResizeUrl:function(e,t,i){var r=e.match(/resize=([0-9%2C,]+)/);if(r===null||!r[1]){return e}var n=r[1].split(",");var a=null;if(n[0]!==t){a=t}if(n[1]!==i){if(a!==null){a+="%2C"}a+=i}if(a!==r[1]){a="resize="+a;e=e.replace(r[0],a)}return e},init:function(){var e=this;try{e.zoomImages();e.timer=setInterval(function(){e.zoomImages()},e.interval)}catch(e){}},stop:function(){if(this.timer)clearInterval(this.timer)},getScale:function(){var e=detectZoom.device();if(e>3){e=Math.ceil(e*2)/2}return e},shouldZoom:function(e){var t=this;if("innerWidth"in window&&!window.innerWidth)return false;if(e==1&&t.zoomed==false)return false;return true},zoomImages:function(){var e=this;var t=e.getScale();if(!e.shouldZoom(t)){return}e.zoomed=true;var i=document.getElementsByTagName("img");for(var r=0;r<i.length;r++){if("complete"in i[r]&&!i[r].complete)continue;if(i[r].hasAttribute("srcset")&&i[r].hasAttribute("sizes")&&"sizes"in i[r]){continue}var n=i[r].getAttribute("scale");if(n==t||n=="0")continue;var a=i[r].getAttribute("scale-fail");if(a&&a<=t)continue;if(!(i[r].width&&i[r].height))continue;if(!n&&i[r].getAttribute("data-lazy-src")&&i[r].getAttribute("data-lazy-src")!==i[r].getAttribute("src"))continue;if(e.scaleImage(i[r],t)){i[r].setAttribute("scale",t)}else{i[r].setAttribute("scale","0")}}},scaleImage:function(e,t){var i=this;var r=e.src;if(e.parentNode.className.match(/slideshow-slide/))return false;if(e.src.match(/^https?:\/\/([^\/]*\.)?gravatar\.com\/.+[?&](s|size)=/)){r=e.src.replace(/([?&](s|size)=)(\d+)/,function(r,n,a,o){var s="originals",c=e.getAttribute(s);if(c===null){c=o;e.setAttribute(s,c);if(i.imgNeedsSizeAtts(e)){e.width=e.width;e.height=e.height}}var u=e.clientWidth;var l=Math.ceil(e.clientWidth*t);l=Math.max(l,c);l=Math.min(l,512);return n+l})}else if(e.src.match(/^https?:\/\/([^\/]+)\.files\.wordpress\.com\/.+[?&][wh]=/)){if(e.src.match(/[?&]crop/))return false;var n={};var a=e.src.match(/([?&]([wh])=)(\d+)/g);for(var o=0;o<a.length;o++){var s=a[o].split("=");var c=s[0].replace(/[?&]/g,"");var u=s[1];var l="original"+c,d=e.getAttribute(l);if(d===null){d=u;e.setAttribute(l,d);if(i.imgNeedsSizeAtts(e)){e.width=e.width;e.height=e.height}}var h=c=="w"?e.clientWidth:e.clientHeight;var f=c=="w"?e.naturalWidth:e.naturalHeight;var m=Math.ceil(h*t);m=Math.max(m,d);if(t>e.getAttribute("scale")&&m<=f)m=u;if(f<u)m=u;if(m!=u)n[c]=m}var v=n.w||false;var g=n.h||false;if(v){r=e.src.replace(/([?&])w=\d+/g,function(e,t){return t+"w="+v})}if(g){r=r.replace(/([?&])h=\d+/g,function(e,t){return t+"h="+g})}}else if(e.src.match(/^https?:\/\/([^\/]+\.)*(wordpress|wp)\.com\/mshots\/.+[?&]w=\d+/)){r=e.src.replace(/([?&]w=)(\d+)/,function(r,n,a){var o="originalw",s=e.getAttribute(o);if(s===null){s=a;e.setAttribute(o,s);if(i.imgNeedsSizeAtts(e)){e.width=e.width;e.height=e.height}}var c=e.clientWidth;var u=Math.ceil(c*t);u=Math.max(u,s);if(t>e.getAttribute("scale")&&u<=e.naturalWidth)u=a;if(a!=u)return n+u;return r});r=r.replace(/([?&]h=)(\d+)/,function(i,n,a){if(r==e.src){return i}var o="originalh",s=e.getAttribute(o);if(s===null){s=a;e.setAttribute(o,s)}var c=e.clientHeight;var u=Math.ceil(c*t);u=Math.max(u,s);if(t>e.getAttribute("scale")&&u<=e.naturalHeight)u=a;if(a!=u)return n+u;return i})}else if(e.src.match(/^https?:\/\/([^\/.]+\.)*(wp|wordpress)\.com\/imgpress\?(.+)/)){var p=["zoom","url","h","w","fit","filter","brightness","contrast","colorize","smooth","unsharpmask"];var w=RegExp.$3.split("&");for(var b in w){b=w[b].split("=")[0];if(p.indexOf(b)==-1){return false}}e.width=e.width;e.height=e.height;if(t==1)r=e.src.replace(/\?(zoom=[^&]+&)?/,"?");else r=e.src.replace(/\?(zoom=[^&]+&)?/,"?zoom="+t+"&")}else if(e.src.match(/^https?:\/\/([^\/.]+\.)*(wp|wordpress)\.com\/latex\.php\?(latex|zoom)=(.+)/)||e.src.match(/^https?:\/\/i[\d]{1}\.wp\.com\/(.+)/)){if(navigator.userAgent.indexOf("Firefox")>-1){return}e.width=e.width;e.height=e.height;if(t==1)r=e.src.replace(/\?(zoom=[^&]+&)?/,"?");else r=e.src.replace(/\?(zoom=[^&]+&)?/,"?zoom="+t+"&");if(!e.srcset&&e.src.match(/resize/)){r=i.updateResizeUrl(r,e.width,e.height);e.setAttribute("srcset",r)}}else if(e.src.match(/^https?:\/\/[^\/]+\/.*[-@]([12])x\.(gif|jpeg|jpg|png)(\?|$)/)){e.width=e.width;e.height=e.height;var z=RegExp.$1,x=z;if(t<=1)x=1;else x=2;if(z!=x)r=e.src.replace(/([-@])[12]x\.(gif|jpeg|jpg|png)(\?|$)/,"$1"+x+"x.$2$3")}else{return false}if(r!=e.src){var A,P=e.getAttribute("src-orig");if(!P){P=e.src;e.setAttribute("src-orig",P)}A=e.src;e.onerror=function(){e.src=A;if(e.getAttribute("scale-fail")<t)e.setAttribute("scale-fail",t);e.onerror=null};e.src=r}return true}};wpcom_img_zoomer.init();